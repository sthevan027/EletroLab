import{h as n}from"./pdf-vendor-Duu-vOQv.js";async function t(t,e={format:"pdf",includeTests:!0,includeCharts:!1,includeMetadata:!0,includeComments:!1}){const a=function(n,t){const e=t.includeMetadata?`\n    <div class="metadata">\n      <p><strong>Categoria:</strong> ${n.category}</p>\n      ${n.tag?`<p><strong>Tag:</strong> ${n.tag}</p>`:""}\n      ${n.manufacturer?`<p><strong>Fabricante:</strong> ${n.manufacturer}</p>`:""}\n      ${n.model?`<p><strong>Modelo:</strong> ${n.model}</p>`:""}\n      ${n.client?`<p><strong>Cliente:</strong> ${n.client}</p>`:""}\n      ${n.site?`<p><strong>Local:</strong> ${n.site}</p>`:""}\n      ${n.operator?`<p><strong>Operador:</strong> ${n.operator}</p>`:""}\n    </div>\n  `:"";return`\n    <!DOCTYPE html>\n    <html>\n    <head>\n      <meta charset="UTF-8">\n      <title>Relatório IR - ${n.category}</title>\n      <style>\n        body {\n          font-family: 'Courier New', monospace;\n          font-size: 10px;\n          margin: 0;\n          padding: 10px;\n          background: white;\n        }\n        .header {\n          text-align: center;\n          border-bottom: 2px solid #000;\n          padding-bottom: 5px;\n          margin-bottom: 10px;\n        }\n        .title {\n          font-size: 14px;\n          font-weight: bold;\n          margin: 0;\n        }\n        .metadata {\n          font-size: 8px;\n          margin-bottom: 10px;\n        }\n        .metadata p {\n          margin: 2px 0;\n        }\n        .readings-table {\n          width: 100%;\n          border-collapse: collapse;\n          margin: 10px 0;\n        }\n        .readings-table th,\n        .readings-table td {\n          border: 1px solid #000;\n          padding: 3px;\n          text-align: center;\n          font-size: 9px;\n        }\n        .readings-table th {\n          background: #f0f0f0;\n          font-weight: bold;\n        }\n        .dai {\n          text-align: center;\n          font-weight: bold;\n          font-size: 12px;\n          margin-top: 10px;\n          padding: 5px;\n          border: 2px solid #000;\n        }\n        .footer {\n          font-size: 8px;\n          text-align: center;\n          margin-top: 10px;\n          border-top: 1px solid #000;\n          padding-top: 5px;\n        }\n      </style>\n    </head>\n    <body>\n      <div class="header">\n        <h1 class="title">RELATÓRIO IR - ${n.category.toUpperCase()}</h1>\n        <p>Data: ${n.createdAt.toLocaleDateString("pt-BR")}</p>\n      </div>\n      \n      ${e}\n      \n      <table class="readings-table">\n        <thead>\n          <tr>\n            <th>Tempo</th>\n            <th>kV</th>\n            <th>Resistência</th>\n          </tr>\n        </thead>\n        <tbody>\n          ${n.readings.map(n=>`\n            <tr>\n              <td>${n.time}</td>\n              <td>${n.kv}</td>\n              <td>${n.resistance}</td>\n            </tr>\n          `).join("")}\n        </tbody>\n      </table>\n      \n      <div class="dai">\n        DAI: ${n.dai}\n      </div>\n      \n      <div class="footer">\n        <p>Gerado por EletriLab Ultra-MVP</p>\n        <p>${(new Date).toLocaleString("pt-BR")}</p>\n      </div>\n    </body>\n    </html>\n  `}(t,e),i={margin:[5,5,5,5],filename:`relatorio_ir_${t.category}_${(new Date).toISOString().split("T")[0]}.pdf`,image:{type:"jpeg",quality:.98},html2canvas:{scale:2,useCORS:!0},jsPDF:{unit:"mm",format:"a7",orientation:"portrait"}};return await n().from(a).set(i).outputPdf("blob")}async function e(t,e={format:"pdf",includeTests:!0,includeCharts:!0,includeMetadata:!0,includeComments:!0}){const a=function(n,t){const e=n.equipment||{tag:""},a=n.summary||{phaseCount:0,averageResistance:0,status:""},i=t.includeMetadata?`\n    <div class="metadata">\n      <div class="metadata-grid">\n        <div class="metadata-item">\n          <span class="label">Equipamento:</span>\n          <span class="value">${e.tag||"N/A"}</span>\n        </div>\n        <div class="metadata-item">\n          <span class="label">Operador:</span>\n          <span class="value">${n.operator||"N/A"}</span>\n        </div>\n        <div class="metadata-item">\n          <span class="label">Total de Fases:</span>\n          <span class="value">${a.phaseCount||"N/A"}</span>\n        </div>\n        <div class="metadata-item">\n          <span class="label">Status:</span>\n          <span class="value status-${a.status?.toLowerCase()||"unknown"}">${a.status||"N/A"}</span>\n        </div>\n        ${e.model?`\n        <div class="metadata-item">\n          <span class="label">Modelo:</span>\n          <span class="value">${e.model}</span>\n        </div>\n        `:""}\n        <div class="metadata-item">\n          <span class="label">Data/Hora:</span>\n          <span class="value">${n.createdAt.toLocaleString("pt-BR")}</span>\n        </div>\n      </div>\n    </div>\n  `:"",o=n.readings?.map(n=>`\n    <tr>\n      <td>${n.phase}</td>\n      <td>${n.time}</td>\n      <td>${n.resistance}</td>\n      ${n.temperature?`<td>${n.temperature}°C</td>`:"<td>-</td>"}\n      ${n.humidity?`<td>${n.humidity}%</td>`:"<td>-</td>"}\n    </tr>\n  `).join("")||"";return`\n    <!DOCTYPE html>\n    <html>\n    <head>\n      <meta charset="UTF-8">\n      <title>Relatório Multi-Fase - ${e.tag||"Equipamento"}</title>\n      <style>\n        * {\n          margin: 0;\n          padding: 0;\n          box-sizing: border-box;\n        }\n        \n        body {\n          font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n          font-size: 11px;\n          line-height: 1.4;\n          color: #333;\n          background: white;\n          padding: 15mm;\n        }\n        \n        .header {\n          text-align: center;\n          border-bottom: 3px solid #2563eb;\n          padding-bottom: 15px;\n          margin-bottom: 20px;\n        }\n        \n        .logo {\n          font-size: 24px;\n          font-weight: bold;\n          color: #2563eb;\n          margin-bottom: 5px;\n        }\n        \n        .title {\n          font-size: 18px;\n          font-weight: bold;\n          color: #1f2937;\n          margin-bottom: 5px;\n        }\n        \n        .subtitle {\n          font-size: 12px;\n          color: #6b7280;\n        }\n        \n        .metadata {\n          background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);\n          border: 1px solid #cbd5e1;\n          border-radius: 8px;\n          padding: 15px;\n          margin-bottom: 20px;\n        }\n        \n        .metadata-grid {\n          display: grid;\n          grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n          gap: 10px;\n        }\n        \n        .metadata-item {\n          display: flex;\n          justify-content: space-between;\n          align-items: center;\n          padding: 5px 0;\n        }\n        \n        .metadata-item .label {\n          font-weight: 600;\n          color: #374151;\n        }\n        \n        .metadata-item .value {\n          font-weight: 500;\n          color: #1f2937;\n        }\n        \n        .status-ok {\n          color: #059669;\n          font-weight: bold;\n        }\n        \n        .status-warning {\n          color: #d97706;\n          font-weight: bold;\n        }\n        \n        .status-error {\n          color: #dc2626;\n          font-weight: bold;\n        }\n        \n        .summary-section {\n          background: #f1f5f9;\n          border-left: 4px solid #2563eb;\n          padding: 15px;\n          margin-bottom: 20px;\n          border-radius: 0 8px 8px 0;\n        }\n        \n        .summary-title {\n          font-size: 14px;\n          font-weight: bold;\n          color: #1e40af;\n          margin-bottom: 10px;\n        }\n        \n        .summary-grid {\n          display: grid;\n          grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));\n          gap: 10px;\n        }\n        \n        .summary-item {\n          text-align: center;\n          padding: 8px;\n          background: white;\n          border-radius: 6px;\n          border: 1px solid #e2e8f0;\n        }\n        \n        .summary-item .label {\n          font-size: 10px;\n          color: #6b7280;\n          text-transform: uppercase;\n          letter-spacing: 0.5px;\n        }\n        \n        .summary-item .value {\n          font-size: 16px;\n          font-weight: bold;\n          color: #1f2937;\n          margin-top: 2px;\n        }\n        \n        .readings-section {\n          margin-bottom: 20px;\n        }\n        \n        .section-title {\n          font-size: 14px;\n          font-weight: bold;\n          color: #1e40af;\n          margin-bottom: 10px;\n          padding-bottom: 5px;\n          border-bottom: 2px solid #e5e7eb;\n        }\n        \n        .readings-table {\n          width: 100%;\n          border-collapse: collapse;\n          margin-bottom: 20px;\n          background: white;\n          border-radius: 8px;\n          overflow: hidden;\n          box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\n        }\n        \n        .readings-table th {\n          background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);\n          color: white;\n          font-weight: 600;\n          text-align: center;\n          padding: 10px 8px;\n          font-size: 10px;\n          text-transform: uppercase;\n          letter-spacing: 0.5px;\n        }\n        \n        .readings-table td {\n          padding: 8px;\n          text-align: center;\n          border-bottom: 1px solid #e5e7eb;\n          font-size: 10px;\n        }\n        \n        .readings-table tr:nth-child(even) {\n          background: #f8fafc;\n        }\n        \n        .readings-table tr:hover {\n          background: #e0f2fe;\n        }\n        \n        .footer {\n          margin-top: 30px;\n          padding-top: 15px;\n          border-top: 2px solid #e5e7eb;\n          text-align: center;\n          font-size: 9px;\n          color: #6b7280;\n        }\n        \n        .footer .company {\n          font-weight: bold;\n          color: #2563eb;\n          margin-bottom: 5px;\n        }\n        \n        .footer .timestamp {\n          color: #9ca3af;\n        }\n        \n        @media print {\n          body {\n            padding: 10mm;\n          }\n          \n          .readings-table {\n            page-break-inside: avoid;\n          }\n        }\n      </style>\n    </head>\n    <body>\n      <div class="header">\n        <div class="logo">EletriLab</div>\n        <h1 class="title">RELATÓRIO MULTI-FASE</h1>\n        <p class="subtitle">Análise de Resistência de Isolamento - Equipamentos Multi-Fase</p>\n      </div>\n      \n      ${i}\n      \n      <div class="summary-section">\n        <div class="summary-title">Resumo do Teste</div>\n        <div class="summary-grid">\n          <div class="summary-item">\n            <div class="label">Fases Testadas</div>\n            <div class="value">${a.phaseCount||"N/A"}</div>\n          </div>\n          <div class="summary-item">\n            <div class="label">Resistência Média</div>\n            <div class="value">${a.averageResistance?`${a.averageResistance} MΩ`:"N/A"}</div>\n          </div>\n          <div class="summary-item">\n            <div class="label">Status Geral</div>\n            <div class="value status-${a.status?.toLowerCase()||"unknown"}">${a.status||"N/A"}</div>\n          </div>\n          <div class="summary-item">\n            <div class="label">Confiança IA</div>\n            <div class="value">${Math.round(100*n.confidence||85)}%</div>\n          </div>\n        </div>\n      </div>\n      \n      <div class="readings-section">\n        <div class="section-title">Leituras de Resistência</div>\n        <table class="readings-table">\n          <thead>\n            <tr>\n              <th>Fase</th>\n              <th>Tempo</th>\n              <th>Resistência</th>\n              <th>Temp.</th>\n              <th>Umid.</th>\n            </tr>\n          </thead>\n          <tbody>\n            ${o}\n          </tbody>\n        </table>\n      </div>\n      \n      <div class="footer">\n        <div class="company">EletriLab Ultra-MVP</div>\n        <div class="timestamp">Gerado em ${(new Date).toLocaleString("pt-BR")} | Powered by AI</div>\n      </div>\n    </body>\n    </html>\n  `}(t,e),i={margin:[8,8,8,8],filename:`relatorio_multifase_${t.equipment?.tag||"equipamento"}_${(new Date).toISOString().split("T")[0]}.pdf`,image:{type:"jpeg",quality:.95},html2canvas:{scale:2,useCORS:!0,letterRendering:!0,allowTaint:!0,backgroundColor:"#ffffff"},jsPDF:{unit:"mm",format:"a4",orientation:"portrait",compress:!0},pagebreak:{mode:["avoid-all","css","legacy"]}};return await n().from(a).set(i).outputPdf("blob")}function a(n,t,e){const a=n instanceof Blob?n:new Blob([n],{type:e}),i=URL.createObjectURL(a),o=document.createElement("a");o.href=i,o.download=t,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(i)}async function i(n,e="pdf",i={format:e,includeTests:!0,includeCharts:!1,includeMetadata:!0,includeComments:!1}){const o=(new Date).toISOString().split("T")[0],s=`relatorio_ir_${n.category}_${o}`;if("pdf"===e){a(await t(n,i),`${s}.pdf`,"application/pdf")}else{const t=function(n){const t=n.readings.map(n=>[n.time,n.kv,n.resistance]);return t.push(["DAI","",n.dai]),n.tag&&t.push(["Tag","",n.tag]),n.manufacturer&&t.push(["Fabricante","",n.manufacturer]),n.model&&t.push(["Modelo","",n.model]),n.client&&t.push(["Cliente","",n.client]),n.site&&t.push(["Local","",n.site]),n.operator&&t.push(["Operador","",n.operator]),[["Tempo","kV","Resistência"].join(","),...t.map(n=>n.join(","))].join("\n")}(n);a(t,`${s}.csv`,"text/csv")}}async function o(n,t="pdf",i={format:t,includeTests:!0,includeCharts:!0,includeMetadata:!0,includeComments:!0}){const o=(new Date).toISOString().split("T")[0],s=`relatorio_multifase_${n.reports?.length||0}_fases_${o}`;if("pdf"===t){a(await e(n,i),`${s}.pdf`,"application/pdf")}else{const t=function(n){const t=[];return(n.reports||[]).forEach(n=>{n.readings.forEach((e,a)=>{t.push([n.id,n.testNo.toString(),n.type,n.description,n.phases.join("/"),e.time,e.kv,e.resistance,3===a?n.dai:"",3===a?n.comments:""])})}),[["Report ID","Test No","Type","Description","Phases","Time","kV","Resistance","DAI","Comments"].join(","),...t.map(n=>n.join(","))].join("\n")}(n);a(t,`${s}.csv`,"text/csv")}}export{e as a,i as b,o as c,t as e};
